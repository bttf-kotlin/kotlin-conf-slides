// Theme
:revealjs_customtheme: css/theme/bttf.css

:revealjs_slideNumber: true
//:revealjsdir: https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0

//:revealjs_width: "100%"
//:revealjs_height: "100%"
//:revealjs_margin: 0
//:revealjs_minScale: 1
//:revealjs_maxScale: 1

:source-highlighter: highlightjs
// :highlightjsdir: highlightjs
// :highlightjs-theme: "tomorrow-night-blue"


:imagesdir: images
:title-slide-transition: zoom
:title-slide-transition-speed: fast


= BREIZH < : [title-left-part]#to the# camp

[NOTE.speaker]
--
M: Doc ? Doc ? Vous √™tes o√π ?

_Marty recherche Doc et avance au slide suivant_ :D
--

== PREVIOUSLY&nbsp;ON&nbsp;BREIZHCAMP

[actor-role]#Doc# est parti quelques ann√©es dans le pass√© pour comprendre comment on d√©veloppait des applications `Java`.

[NOTE.speaker]
--
D: Martyyy, tu tombes bien! Je reviens du pass√© et j'ai d√©couvert quelquechose d'horrible.
Malgr√© les efforts de nombreuses personnes, la plateforme cfp.io est vou√©e √† dispara√Ætre.

M: Mais Doc c'est pas justement l√† que l'on a post√© notre conf√©rence pour le BreizhCamp.

D: Si Marty, mais des gens bien intentionn√© ont pr√©f√©r√© l'abandonner car il manque des fonctionnalit√©s et il y a des bugs.

M: Mais pourquoi n'ont elle pas √©t√© ajout√©es ? La plateforme est open source, non ?

D: Vient Marty, je te montre.
--

== IN THE PAST OF CFP.IO


[source,bash]
----
commit cfc41bb48e4fc66dd2bf04588e24f590147cef45
Author: Nicolas De Loof <nicolas.deloof@gmail.com>
Date:   Tue Apr 25 16:24:44 2017 +0200

    ah le code legacy,
    m√™me pas foutu de respected la norme javabean :-\

commit 771136b238f375edf44c092c8c37b6014919e6cf
Author: Nicolas De Loof <nicolas.deloof@gmail.com>
Date:   Wed Mar 8 19:15:11 2017 +0100

    java Date API sucks

commit 2b67097a80dc5e970b12665924ebc73b751adc10
Merge: f9fcc1b9 5b11b30d
Author: Marc <marc.audefroy@ovh.fr>
Date:   Tue Dec 8 18:27:06 2015 +0100

    Merge branch 'cospeakers'   Note du dev : GRRRRRRR

    Conflicts:
            src/main/java/fr/sii/controller/restricted/session/SessionController.java
            src/main/java/fr/sii/dto/TalkUser.java
            src/main/java/fr/sii/dto/mapping/TalkMapping.java
            src/main/java/fr/sii/service/TalkUserService.java
            src/main/resources/changelog/changelog-1.0.xml
            src/main/static/app/scripts/controllers/restricted/talks/edit.js

commit dc41801e45d6c1c23b17325eafe712824808e9be
Author: Nicolas De Loof <nicolas.deloof@gmail.com>
Date:   Sat Nov 7 14:33:42 2015 +0100

    can‚Äôt run with java 8

----



[NOTE.speaker]
--
M: Heu... Doc ? C'est moi o√π c'est du Java.

D: Tu sais Marty, √† l'√©poque il n'y avait pas trop de choix.

M: On pourrait pas utiliser Kotlin pour rajouter du code ?

D: Nom de Zeus, tu as raison Marty. Kotlin, c'est le back du futur.
On peut faire la m√™me chose que Java et bien plus encore.
--

[transition=zoom]
== !

[header]#KOTLIN <# [hearder-line]#> LE BACK DU FUTUR#

== STARRING

image::adrien.png[size=contain, role="actor"]

Adrien Pessu as [.actor-role]#Marty#

Freelance

üê¶ @adrien_pe

== AND

image::gautier.png[size=contain, role="actor"]

Gautier de Saint Martin Lacaze as [actor-role]#Doc#

Freelance & Nantes JUG Leader

üê¶ @darkjabberwock

== LES BASES DE LA SYNTAXE

[transition=fade]
=== VAL VS VAR

// Adrien

[source,kotlin,subs="quotes"]
----
val quote: String = "All√¥ ? All√¥ ?"





//
----

[transition=fade]
=== VAL VS VAR

// Adrien

[source,kotlin,subs="quotes"]
----
val name = "McFly"

var quote: String

quote = """ All√¥ ? All√¥ ?
| Y'a personne au bout du fil ?
| Faut r√©fl√©chir ${name} !
| Faut r√©fl√©chir
"""
----

[NOTE.speaker]
--
val correspond √† une valeur non modifiable.
Doit √™tre initialis√©e lors de la d√©claration.

var peut varier.
Peut √™tre initialis√© plus tard.
--

=== TYPE BASIQUE

// Gautier

[%step]
* Pas de type primitif
* Any
* Double, Float, Int...
* Char, String
* Boolean

[transition=fade]
=== ARRAY

// Gautier


[source,kotlin]
----
val versions: Array<Int> = arrayOf(1, 2, 4)
versions[2] = 3

val sentence = "Il y a ${versions.size} films. Le dernier est le ${versions[versions.size - 1]}."
print(sentence)
----

[NOTE.speaker]
--
* G√©n√©riques
* get/set => []
--

[transition=fade]
=== ARRAY

// Gautier

[source,kotlin]
----
val versions: IntArray = intArrayOf(1, 2, 4)
versions[2] = 3

val sentence = "Il y a ${versions.size} films. Le dernier est le ${versions[versions.size - 1]}."
print(sentence)
----

[NOTE.speaker]
--
* specialized classes : IntArray, ShortArray...
--

=== ARRAY

// Gautier

[source,kotlin]
----
val versions: Array<Int> = arrayOf(1, 2, 3)
val anyVersions: Array<Any> = versions // won't compile
----

[NOTE.speaker]
--
* invariant =>  assign an Array<String> to an Array<Any> impossible
--


=== RANGE

// Adrien

[source,kotlin]
----
if (i in 1..3) {
  println("""Retour vers le futur ${i}""")
}

for (i in IntRange(1, 3)) {
  println("""Retour vers le futur ${i}""")
}
----

[transition=fade]
=== RANGE

// Adrien

[source,kotlin]
----
for (i in 1..4 step 2) {
  println("""Retour vers le futur ${i}""")
}

for (i in 4 downTo 1 step 2) {
  println("""Retour vers le futur ${i}""")
}
----

=== SMART CAST

[source,kotlin]
----
if (talk !is String) return
print(talk.length)
----

[transition=fade]
=== SMART CAST

[source,kotlin]
----
val talk: String? = y as String?
val talk: String? = y as? String
----

[NOTE.speaker]
--
unsafe throw exception / safe return null
--

=== D√âCLARATION FONCTIONS

// Gautier

[source,kotlin,subs="quotes"]
----
fun speakerName(name: String, firstname: String) : String {
    return "${name} ${firstname}"
}
----

[NOTE.speaker]
--
* fun
* globale / locale
* d√©claration param√®tre
* type retour
** Unit si pas de retour
--

[transition=fade]
=== D√âCLARATION FONCTIONS

// Gautier

[source,kotlin,subs="quotes"]
----
fun speakerNameInline(name: String, firstname: String) = "${name} ${firstname}"

// - 2.21 Gigowatts !! 2.21 Gigowatts !! Mon dieu !
----

[NOTE.speaker]
--
* inline
* type retour optionnel
--

=== PARAMETRE FACULTATIF

// Gautier

[source,kotlin,subs="quotes"]
----
fun printHello(name: String?): Unit {
  if (name != null)
    println("Hello ${name}")
  else
   println("Hi there!")
}
----

=== VALEUR PAR D√âFAUT

// Gautier

[source,kotlin,subs="quotes"]
----
fun printMessage(name: String = "gallette-saucisses"): Unit {
    println("Au BreizhCamp on aime les ${name} !")
}

fun main(args: Array<String>) {
    printMessage()                  // Au BreizhCamp on aime les gallette-saucisses !
    printMessage("chapeaux ronds")  // Au BreizhCamp on aime les chapeaux ronds !
}
----

=== PARAMETRE NOMM√â


[source,kotlin]
----
fun buildMessage(
        name: String,
        upper: Boolean,
        withEmoji: Boolean
): String {

 // ...

}
----

[transition=fade]
=== PARAMETRE NOMM√â

[source,kotlin]
----
val message = buildMessage("Christopher Lloyd", true, false)
----

[transition=fade]
=== PARAMETRE NOMM√â

[source,kotlin]
----
val messageWithNamedArguments = buildMessage("Christopher Lloyd", withEmoji = false, upper = true)
----

=== LAMBDA / IT

// Gautier

[source,kotlin,subs="quotes"]
----
strings
  .filter { it.length == 5 }
  .sortedBy { it }
  .map { it.toUpperCase() }
----

[NOTE.speaker]
--
it correspond √† l'√©lement courant

lambda sans utilisation des `arrows`
--

=== CLASS

// Adrien

[source,kotlin,subs="quotes"]
----
class UserServices(val name: String, val age: Int) {
  var credentials: Credentials;
  fun getUsers()...
}
----

=== OBJECT CLASS

// Adrien

[source,kotlin,subs="quotes"]
----
object class MySingleton
----

[NOTE.speaker]
--
Pas de constructeur
--

=== DATA CLASS

// Adrien

[source,kotlin,subs="quotes"]
----
data class User(val name: String, val age: Int)
----

[NOTE.speaker]
--
pas besoin de lombock
--

=== DATA CLASS

// adrien

[source,kotlin,subs="quotes"]
----
people.copy(age = 32)
----

=== OVERLOADING JAVA

//adrien

[source,java,subs="quotes"]
----
class RegisterService{
  public RegisterService(String speaker){
    this.speaker = speaker;
    this.isFromBzh = true;
  }
  public RegisterService(String speaker, String coSpeaker){
    this.speaker = speaker;
    this.coSpeaker = coSpeaker;
    this.isFromBzh = true;
  }
  public RegisterService(String speaker, String coSpeaker, Boolean isFromBzh){
    this.speaker = speaker;
    this.coSpeaker = coSpeaker;
    this.isFromBzh = isFromBzh;
  }
}
----

[transition=fade]
=== OVERLOADING KOTLIN

//adrien

[source,kotlin,subs="quotes"]
----
class RegisterService(val speaker: String, val coSpeaker: String?, val isFromBzh = true)














// BZH
----

== FLOW CONTROL

=== IF

// Gautier

[source,kotlin,subs="quotes"]
----
val max = if (a > b) {
  print("Choose a")
  a
} else {
  print("Choose b")
  b
}
----

[NOTE.speaker]
--
* expression => renvoit une valeur
* remplace l'op√©rateur ternaire
* derniere expression = valeur renvoy√©e
--

=== ELVIS OPERATOR

// Gautier

[source,kotlin,subs="quotes"]
----
val city = user?.adress?
  .city ?: throw IllegalArgumentException("Invalid User")
----

[source,kotlin,subs="quotes"]
----
findOrder()?.let { dun(it.customer) }
----

[NOTE.speaker]
--
* simplification du null check
* invocation du reste du code que si pas null
--

=== WHEN

// Adrien

[source,kotlin,subs="quotes"]
----
when (year) {
  1985 -> print("Go in the past")
  1955 -> findDoc()
  2015, 2016 -> wearCoolShoes()
  in 2018..2030 -> useKotlin()
  nomDeZeus() -> print("Personne ne me dit que j'ai les foies")
  is String -> print(year)
  else -> {
    print("Qui t'appelles ¬´ banane ¬ª, banane ?")
  }
}
----

=== TRY CATCH

// Gautier

[source,kotlin,subs="quotes"]
----
val answer: Int = try {
  parseInt(input)
}
catch (e: NumberFormatException) {
  42
}
----

[NOTE.speaker]
--
* expression => renvoit valeur
* au moins un catch ou un finally
--

=== BREAK LABEL

//  Adrien

[source,kotlin,subs="quotes"]
----
loop@ for (i in 1..100) {
    for (j in 1..100) {
        if (...) break@loop
    }
}
----

=== RETURN LABEL

// Adrien

// Si trop long, on vire

[source,kotlin,subs="quotes"]
----
fun foo() {
    listOf(1, 2, 3, 4, 5).forEach {
        if (it == 3) return // non-local return directly to the caller of foo()
        print(it)
    }
    println("this point is unreachable")
}

fun foo() {
    listOf(1, 2, 3, 4, 5).forEach lit@{
        if (it == 3) return@lit
        print(it)
    }
    print(" done with explicit label")
}
----

[transition=fade]
== KOTLIN STANDARD LIBRARY

// Adrien

[source,kotlin,subs="quotes"]
----
val speaker = "McFly"
val year = 1985
if(speaker.isNotBlank()){
  print("""BTTF with ${speaker.capitalize()}""")
  print(year.plus(33))
}
----

[transition=fade]
=== KOTLIN STANDARD LIBRARY

// Adrien

[source,kotlin,subs="quotes"]
----
val years = arrayOf(1985, 1992, 2018)
print(years.average())
Talk.apply{remainingTime = 20}


//
----
[NOTE.speaker]
--
Shape of the code
--

== FUNCTIONAL PROGRAMMING

// Gautier

Kotlin n'est pas un langage fonctionnel.

[source,kotlin,subs="quotes"]
----
fun <T> lock(lock: Lock, body: () -> T): T {
  lock.lock()
  try {
      return body()
  }
  finally {
      lock.unlock()
  }
}
----

[NOTE.speaker]
--
Possibilit√© de faire du fonctionnel

Parler de Pair

Parler de triple

Destructuring fonction

Pas de Either par default / mais il existe Arrow
--

== COROUTINE

&nbsp;

&nbsp;

&nbsp;

[NOTE.speaker]
--
* coroutine => thread l√©ger collaboratif. transition vers une autre coroutine √† sa demande.

* thread => scheduleur pr√©-emptif.horloges synchronisent les changements de contextes.
--

[transition=fade]
=== COROUTINE

// Adrien

[source,kotlin,subs="quotes"]
----
val messUpParentProm = async(1955Context){...}

val findPower = async(1955Context){...}

suspend fun journeyInThePast(): String {
    messUpParentProm().await()
    findPower().await()
    return "Marty"
}

launch() {
    print("fight Lebaneses")
    print(journeyInThePast().await())
    print("go away from Lebaneses")
}
----

[NOTE.speaker]
--
* Thead block
* Async no blocking but work with context
* suspend no blocking and return value 
--

== EXTENSIONS

// Gautier

Le polyfill du Java dans Kotlin

[source,kotlin,subs="quotes"]
----
class Hero {
  fun useSuperpowers() {
    println("Applied super powers")
  }
}

fun Hero.savePlanet() {
  useSuperpowers()
}

val superman = Hero()
superman.savePlanet()
----

[NOTE.speaker]
--

provient de C#

--

== COMPANION

// Gautier

[source, kotlin]
----
class User private constructor(val login: String) {
    companion object UserFactory {
        fun create(login: String): User {
            return User(login)
        }
    }
}
----

== KOTLIN ET LES FRAMEWORKS

// Adrien

* Spring Boot + JUnit 5
* jackson-kotlin
* kTor
* Javalin
* Kotlin arrow
* Jhipster-kotlin

== KOTLIN MULTIPLATEFORME

// Gautier

* JVM
* JS
* Natif

== THANKS

Any Question ?
